Num of train data: 1138812
1.0    569406
0.0    569406
Name: set, dtype: int64
Train data: 
Num of data: 569406
Num of unique id: 569406
Num of unique poi: 369987
Mean num of unique poi: 1.5389892077289202
Valid data: 
Num of data: 569406
Num of unique id: 569406
Num of unique poi: 369985
Mean num of unique poi: 1.5389975269267673
set()
Start knn
Start faiss
Num of unique id: 569406
Num of train data: 27099545
Pos rate: 0.021109026000252034
                        id          match_id     kdist  kneighbors  label
18554096  E_e9ed278c54488a  E_f151d5ae264a0d  0.002252          17      0
22138893  E_3e8e11d8f97d45  E_14ccd3f6564e17  0.001640          20      0
7806841   E_e668fd74c39c36  E_3b431e44085e08  3.440453           7      0
18519797  E_da5f583370eb58  E_feacd0a673222b  0.154586          17      0
15588272  E_acb4c17d7873df  E_75ccd2e61eebff  0.774212          14      0
Unique id: 569406
Unique id: 569406
IoU score: 0.9563101341146878
Current split: 1
(5437876, 75)
                        id          match_id     kdist  kneighbors  label  name_sim  name_gesh  name_leven  name_jaro  name_lcs  name_len_diff  name_nleven  name_nlcsk  name_nlcs  address_sim  address_gesh  address_leven  address_jaro  address_lcs  address_len_diff  address_nleven  address_nlcsk  address_nlcs  city_gesh  city_leven  city_jaro  city_lcs  city_len_diff  city_nleven  city_nlcsk  city_nlcs  state_sim  state_gesh  state_leven  state_jaro  state_lcs  state_len_diff  state_nleven  state_nlcsk  state_nlcs  zip_gesh  zip_leven  zip_jaro  zip_lcs  url_sim  url_gesh  url_leven  url_jaro  url_lcs  url_len_diff  url_nleven  url_nlcsk  url_nlcs  phone_gesh  phone_leven  phone_jaro  phone_lcs  categories_sim  categories_gesh  categories_leven  categories_jaro  categories_lcs  categories_len_diff  categories_nleven  categories_nlcsk  categories_nlcs  country_sim  country_gesh  country_leven  country_jaro  country_lcs  country_len_diff  country_nleven  country_nlcsk  country_nlcs
11097952  E_bb4ea6fabe1b96  E_8c38641d92198e  3.930949          10      1  0.664003   0.761905          10   0.707576        16              2     0.454545         0.8   0.727273          1.0           NaN            NaN           NaN          NaN                 0             NaN            NaN           NaN        NaN         NaN        NaN       NaN              0          NaN         NaN        NaN        1.0         NaN          NaN         NaN        NaN               0           NaN          NaN         NaN       NaN        NaN       NaN      NaN      1.0       NaN        NaN       NaN      NaN             0         NaN        NaN       NaN         NaN          NaN         NaN        NaN             0.0              NaN               NaN              NaN             NaN                    5                NaN               NaN              NaN          1.0           1.0            0.0           1.0          2.0                 0             0.0            1.0           1.0
Current split: 2
(5420117, 75)
                        id          match_id     kdist  kneighbors  label  name_sim  name_gesh  name_leven  name_jaro  name_lcs  name_len_diff  name_nleven  name_nlcsk  name_nlcs  address_sim  address_gesh  address_leven  address_jaro  address_lcs  address_len_diff  address_nleven  address_nlcsk  address_nlcs  city_gesh  city_leven  city_jaro  city_lcs  city_len_diff  city_nleven  city_nlcsk  city_nlcs  state_sim  state_gesh  state_leven  state_jaro  state_lcs  state_len_diff  state_nleven  state_nlcsk  state_nlcs  zip_gesh  zip_leven  zip_jaro  zip_lcs  url_sim  url_gesh  url_leven  url_jaro  url_lcs  url_len_diff  url_nleven  url_nlcsk  url_nlcs  phone_gesh  phone_leven  phone_jaro  phone_lcs  categories_sim  categories_gesh  categories_leven  categories_jaro  categories_lcs  categories_len_diff  categories_nleven  categories_nlcsk  categories_nlcs  country_sim  country_gesh  country_leven  country_jaro  country_lcs  country_len_diff  country_nleven  country_nlcsk  country_nlcs
12405613  E_0bfd5905d739b8  E_74ee6313cdd927  0.014196          12      0       0.0   0.246154          34   0.443692         8             19     0.809524    0.347826   0.190476          0.0           NaN            NaN           NaN          NaN                49             NaN            NaN           NaN        NaN         NaN        NaN       NaN              9          NaN         NaN        NaN        0.0         NaN          NaN         NaN        NaN              10           NaN          NaN         NaN       NaN        NaN       NaN      NaN      1.0       NaN        NaN       NaN      NaN             0         NaN        NaN       NaN         NaN          NaN         NaN        NaN             0.0         0.041667              41.0         0.407752             2.0                   38           0.953488               0.4         0.046512          1.0           1.0            0.0           1.0          2.0                 0             0.0            1.0           1.0
Current split: 3
(5413831, 75)
                       id          match_id     kdist  kneighbors  label  name_sim  name_gesh  name_leven  name_jaro  name_lcs  name_len_diff  name_nleven  name_nlcsk  name_nlcs  address_sim  address_gesh  address_leven  address_jaro  address_lcs  address_len_diff  address_nleven  address_nlcsk  address_nlcs  city_gesh  city_leven  city_jaro  city_lcs  city_len_diff  city_nleven  city_nlcsk  city_nlcs  state_sim  state_gesh  state_leven  state_jaro  state_lcs  state_len_diff  state_nleven  state_nlcsk  state_nlcs  zip_gesh  zip_leven  zip_jaro  zip_lcs   url_sim  url_gesh  url_leven  url_jaro  url_lcs  url_len_diff  url_nleven  url_nlcsk  url_nlcs  phone_gesh  phone_leven  phone_jaro  phone_lcs  categories_sim  categories_gesh  categories_leven  categories_jaro  categories_lcs  categories_len_diff  categories_nleven  categories_nlcsk  categories_nlcs  country_sim  country_gesh  country_leven  country_jaro  country_lcs  country_len_diff  country_nleven  country_nlcsk  country_nlcs
2440205  E_55267d520b709d  E_84d3e484849e4b  0.000417           3      0       0.0   0.176471          25        0.0         3             22     0.892857         0.5   0.107143     0.655069      0.444444           30.0           1.0         14.0                25        0.681818       0.318182      0.736842   0.266667         7.0   0.511905       2.0              1        0.875    0.285714       0.25        0.0         0.0          8.0         0.0        0.0               1           1.0          0.0         0.0       NaN        NaN       NaN      NaN  0.075563  0.459016       26.0  0.874743     14.0            13    0.702703   0.583333  0.378378    0.173913         12.0    0.451282        2.0             1.0              1.0               0.0              1.0            19.0                    0                0.0               1.0              1.0          1.0           1.0            0.0           1.0          2.0                 0             0.0            1.0           1.0
Current split: 4
(5413911, 75)
                       id          match_id     kdist  kneighbors  label  name_sim  name_gesh  name_leven  name_jaro  name_lcs  name_len_diff  name_nleven  name_nlcsk  name_nlcs  address_sim  address_gesh  address_leven  address_jaro  address_lcs  address_len_diff  address_nleven  address_nlcsk  address_nlcs  city_gesh  city_leven  city_jaro  city_lcs  city_len_diff  city_nleven  city_nlcsk  city_nlcs  state_sim  state_gesh  state_leven  state_jaro  state_lcs  state_len_diff  state_nleven  state_nlcsk  state_nlcs  zip_gesh  zip_leven  zip_jaro  zip_lcs  url_sim  url_gesh  url_leven  url_jaro  url_lcs  url_len_diff  url_nleven  url_nlcsk  url_nlcs  phone_gesh  phone_leven  phone_jaro  phone_lcs  categories_sim  categories_gesh  categories_leven  categories_jaro  categories_lcs  categories_len_diff  categories_nleven  categories_nlcsk  categories_nlcs  country_sim  country_gesh  country_leven  country_jaro  country_lcs  country_len_diff  country_nleven  country_nlcsk  country_nlcs
6546354  E_a99999f36e2a4d  E_a22642f500cc3d  1.678656           6      0       0.0   0.235294          18   0.437302         5              6          0.9        0.25   0.357143          0.0           NaN            NaN           NaN          NaN                10             NaN            NaN           NaN   0.142857         8.0   0.374074       1.0              4     0.888889         0.2   0.111111        0.0         NaN          NaN         NaN        NaN              11           NaN          NaN         NaN       0.4        3.0       0.6      2.0      1.0       NaN        NaN       NaN      NaN             0         NaN        NaN       NaN         NaN          NaN         NaN        NaN             0.0         0.076923              12.0         0.529293             4.0                    4                0.8          0.363636         0.266667          0.0           0.5            1.0      0.666667          1.0                 0             0.5            0.5           0.5
Current split: 5
(5413810, 75)
                        id          match_id     kdist  kneighbors  label  name_sim  name_gesh  name_leven  name_jaro  name_lcs  name_len_diff  name_nleven  name_nlcsk  name_nlcs  address_sim  address_gesh  address_leven  address_jaro  address_lcs  address_len_diff  address_nleven  address_nlcsk  address_nlcs  city_gesh  city_leven  city_jaro  city_lcs  city_len_diff  city_nleven  city_nlcsk  city_nlcs  state_sim  state_gesh  state_leven  state_jaro  state_lcs  state_len_diff  state_nleven  state_nlcsk  state_nlcs  zip_gesh  zip_leven  zip_jaro  zip_lcs  url_sim  url_gesh  url_leven  url_jaro  url_lcs  url_len_diff  url_nleven  url_nlcsk  url_nlcs  phone_gesh  phone_leven  phone_jaro  phone_lcs  categories_sim  categories_gesh  categories_leven  categories_jaro  categories_lcs  categories_len_diff  categories_nleven  categories_nlcsk  categories_nlcs  country_sim  country_gesh  country_leven  country_jaro  country_lcs  country_len_diff  country_nleven  country_nlcsk  country_nlcs
15713587  E_e54411e766e669  E_f6f28200df5423  3.410816          14      0       0.0   0.533333          16   0.556667        12              5         0.64        0.48        0.6          0.0        0.0625           16.0      0.377646          3.0                 4        0.888889       0.166667      0.214286   0.111111         9.0   0.407407       1.0              0          1.0    0.111111   0.111111        0.0         0.0         13.0         0.0        0.0              11           1.0          0.0         0.0       0.4        4.0  0.433333      2.0      0.0       NaN        NaN       NaN      NaN            16         NaN        NaN       NaN    0.090909         11.0    0.516667        3.0             1.0              1.0               0.0              1.0            13.0                    0                0.0               1.0              1.0          0.0           0.0            2.0           0.0          0.0                 0             1.0            0.0           0.0
27099545
